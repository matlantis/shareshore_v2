<%= render 'edit_common', context: :new_articles %>

<div class="col-xs-12">
  <%= bootstrap_form_for(resource, as: resource_name, url: new_user_articles_path, html: { method: :put }, layout: :horizontal) do |f| %>
    <%= devise_error_messages! %>

    <div class="panel-group" id="accordeon">

      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-titel">
            <a data-toggle="collapse" data-parent="accordeon" href="#Eigene">Eigene</a>
          </h3>
        </div>
        <div id="Eigene" class="panel-collapse collapse">
          <div class="panel-body">

            <%= f.fields_for :articles, @articles['new'], include_id: false do |articles_form| %>
              <% article = articles_form.object %>
              <%= render 'new_article_fields', f: articles_form, article: article %>
            <% end %>

            <div class='links'>
              <%= link_to_add_association 'add article', f, :articles, partial: 'new_article_fields', class: "btn btn-default" %>
            </div>
          </div>
        </div>
      </div>
      
      <% @rooms.each do |room| %>
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3>
              <a data-toggle="collapse" data-parent="accordeon" href="#<%= underscore(room) %>"><%= room %></a>
            </h3>
          </div>

          <div id="<%= underscore(room) %>"  class="panel-collapse collapse">
            <div class="panel-body">

              <%= f.fields_for :articles, @articles[room], include_id: false do |articles_form| %>
                <% # article = @articles[room][articles_form.index] %>
                <% article = articles_form.object %>
                <%= render 'article_fields', f: articles_form, article: article %>
              <% end %>
              
            </div>
          </div>
        </div>
      <% end %>
      <%= f.submit t("Create") %>
    </div>
  <% end %>
</div>

<script>
 
 $(document).ready(function(){
   $(".secondary_article_inputs").hide()
   
   $("#own_article_0_title_field_disabled").keyup( function() {
     var thedivid = "#own_article_" + $(this).attr("data") + "_div";
     ( $(this).val().length == 0 )? $(thedivid).hide(200) : $(thedivid).show(200);
   });

   $(".article_cb").click( function() {
     var thedivid = "#article_" + $(this).attr("data") + "_div";
     console.log(thedivid);
     $(thedivid).toggle(200);
   });
 });
   
</script>
