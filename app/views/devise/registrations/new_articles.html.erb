<script>
 function createCheckBoxClicked(article_cb_id, article_div_id) {
   var cb_checked = document.getElementById(article_cb_id).checked
   var article = document.getElementById(article_div_id)
   var input_fields = article.getElementsByClassName('article_input')
   var i;
   var input_visibility = ( cb_checked )? "visible" : "hidden"
   var text_visibility = (cb_checked )? "hidden" : "visible"
   for (i = 0; i < input_fields.length; i++) {
    input_fields[i].style.visibility = input_visibility
   }
   var text_fields = article.getElementsByClassName('article_text')
   for (i = 0; i < text_fields.length; i++) {
     text_fields[i].style.visibility = text_visibility
   }
 }
</script>

<%= render 'edit_common', context: :new_articles %>

<div class="col-xs-12">
  <%= bootstrap_form_for(resource, as: resource_name, url: new_user_articles_path, html: { method: :put }, layout: :inline) do |f| %>
    <%= devise_error_messages! %>

    <h3>
      <%= link_to "javascript:toggle('Eigene', 'Eigene_toggle_button')", class: "toggle_heading" do %>
        <%= content_tag :span, class: "glyphicon glyphicon-chevron-right", id: "Eigene_toggle_button" do %><% end %>
        Eigene
      <% end %>
    </h3>

    <div id="Eigene" style="display: None;">
      <div class="table">

        <%= render 'article_heading' %>
        
        <%= f.fields_for :articles, @articles['new'], include_id: false do |articles_form| %>
          <% article = articles_form.object %>
          <%= render 'new_article_fields', f: articles_form, article: article %>
        <% end %>

        <div class='links'>
          <%= link_to_add_association 'add article', f, :articles, partial: 'new_article_fields', class: "btn btn-default" %>
        </div>
      </div>
    </div>

    <% @rooms.each do |room| %>
      <h3>
        <%= link_to "javascript:toggle('#{room}', '#{room}_toggle_button')", class: "toggle_heading" do %>
          <%= content_tag :span, class: "glyphicon glyphicon-chevron-right", id: room + "_toggle_button" do %><% end %>
          <%= room %>
        <% end %>
      </h3>

      <%= content_tag :div, id: room, style: "display: None;" do %>
        <div class="table">
          <%= render 'article_heading' %>

          <%= f.fields_for :articles, @articles[room], include_id: false do |articles_form| %>
            <% # article = @articles[room][articles_form.index] %>
            <% article = articles_form.object %>
            <%= render 'article_fields', f: articles_form, article: article %>
          <% end %>
        </div>
      <% end %>
    <% end %>
    <%= f.submit t("Create") %>
  <% end %>
</div>
