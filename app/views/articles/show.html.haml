- @title = @article.title
- @with_map = true
    
-#.col-xs-12
.col-xs-12.col-sm-9
  %h3= @title
  - if is_admin?
    = link_to t('common.action_edit'), edit_article_path(@article), class: "btn btn-danger"

  - unless @article.details == ""
    .row.shareshore-panel
      .col-xs-12
        .p
          %cite
            = succeed '"' do
              = precede '"' do
                = @article.details
    
  .row
    .col-xs-12
      .row
        .col-xs-12
          - if @article.picture.present?
            = image_tag(@article.picture_url, class: "img-responsive")
      .row
        .col-xs-9
          = rate_marker(@article)
          %br/
          = location_marker @article.location
          - if @current_location
            %br/
            %b
              = t('articles.common.label_distance')
              \:
            = "%.1f km" % @article.location.distance_from( @current_location )
          %br/
          = user_marker(@article.user)
        .col-xs-3.text-right
          - if (not @article.stockitem) && user_signed_in? && current_user.role == "admin"
            = render "articles/stockitem_form", stockitem: Stockitem.new.fill_from_article(@article), hidden_fields: true

      - unless ( current_user && current_user.id == @article.user.id )
        .row
          - unless @with_contact
            .col-xs-12
              .shareshore-panel
                %h4= t('.heading_contact_info')
                = bootstrap_form_tag url: article_path(@article), method: :get do |f|
                  = f.form_group do
                    = recaptcha_tags
                  = f.form_group do
                    = f.submit t('.view_contact_details_button'), class: "btn btn-default"
          - else
            .col-xs-12.col-lg-6
              = render 'users/registrations/contact', user: @article.user, showemail: @article.user.showemail, showphone: @article.user.showphone, showname: @article.user.showname, article: @article

            .col-xs-12.col-lg-6
              = link_to '#', class: 'mp-toggle-visibility', data: { toggle_target: '.message-panel' } do
                %h4= t('.heading_request', nickname: @article.user.nickname)
              .clearfix.message-panel.to_hide
                - if user_signed_in?
                  .send-message
                    - request = UserArticleRequest.new({article: @article, with_phoneno: !current_user.phoneno.blank?, with_email: !current_user.email.blank?})
                    = bootstrap_form_for request, remote: true, html: {class: "message_form"} do |f|
                      = f.text_area :text, placeholder: t('.placeholder_request_text'), hide_label: true
                      = f.hidden_field :article_id
                      -#= f.form_group do
                        -# unless current_user.fullname.blank?
                          = f.check_box :with_name, label: "#{UserArticleRequest.human_attribute_name(:with_name)} (#{current_user.fullname})"
                        -# unless current_user.phoneno.blank?
                        = f.check_box :with_phoneno, label: "#{UserArticleRequest.human_attribute_name(:with_phoneno)} (#{current_user.phoneno_or_none})", disabled: current_user.phoneno.blank?
                        -# else
                          = f.hidden_field :with_phoneno
                        -# unless current_user.email.blank?
                        = f.check_box :with_email, label: "#{UserArticleRequest.human_attribute_name(:with_email)} (#{current_user.email_or_none})", disabled: current_user.email.blank?
                        -# else
                          = f.hidden_field :with_email
                      = f.form_group do
                        = f.submit t('.button_label_send_request')
                  .message-was-send{style: "display: none"}
                    = t('.request_was_send')
                    %div
                      %strong
                        = t('.text_read_the_guideline')
                        #{link_to t('titles.pages.guideline'), '/pages/guideline'}.
                  .waiting{style: "display: none"}
                    = t('.waiting')
                  .error-msg{style: "display: none"}
                - else
                  .col-xs-6
                    = t('.text_only_signed_up_users')
                  .col-xs-6.text-right
                    = link_to t('titles.users.sessions.new'), new_user_session_path, class: "btn btn-default"


.col-xs-12.col-sm-3
  = tipp_panel do
    = render 'show_help'

:javascript
  onMapClick = function(e) {
    console.log("You clicked the marker " + e.target.index);
  };
  
  $(document).ready(function() {
    #{render 'articles/map_show.js.erb', houses: [@article.location.house], articles: @article.location.articles, formats: [:js]}
    
  });
