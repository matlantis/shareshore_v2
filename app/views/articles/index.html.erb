<% if @user %>
  <% spec_string = " for " + @user.nickname %>
<% elsif @location %>
  <% spec_string = " at " + @location.shortaddress + " for " + @location.user.nickname %>
<% else %>
  <% spec_string = " near you" %>
<% end %>
  

<% if not @user and not @location %>
<%= form_tag(articles_path, url: articles_path, method: "get", id: "search-form", class: "form") do %>
<div class="form-group">
  <!-- <span class="input-group-addon">Search for</span> -->
  <label class="control-label col-xs-2" for="pattern">Search for</label>
  <div class="col-xs-10">
    <%= text_field_tag :pattern, session[:pattern], placeholder: "Search Articles", class: "form-control" %>
  </div>
</div>
<div class="form-group">
  <label class="control-label col-xs-2" for="radius">within</label>
  <div class="col-xs-10">
    <div class="input-group">
      <%= text_field_tag :radius, session[:radius], placeholder: "Search Radius", class: "form-control" %>
      <span class="input-group-addon">km</span>
    </div>
  </div>
</div>
<div class="form-group">
  <!-- <span class="input-group-addon">km around</span> -->
  <label class="control-label col-xs-2" for="address">around</label>
  <div class="col-xs-10">
    <%= text_field_tag :address, session[:address], placeholder: "address", class: "form-control" %>
  </div>
</div>
<%= submit_tag "Search", class: "btn btn-default btn-sm" %>
<% end %>

<% end %>

<h1>Listing Articles<%= spec_string %></h1>

<table>
  <thead>
    <tr>
      <th>Title</th>
      <th>Details</th>
      <th>Price eur</th>
      <th>Rate</th>
      <th>Gratis</th>
      <th>Deposit eur</th>
      <th>Location</th>
      <th>User</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @articles.each do |article| %>
      <tr>
        <td><%= article.title %></td>
        <td><%= article.details %></td>
        <td><%= article.price_eur %></td>
        <td><%= article.rate %></td>
        <td><%= article.gratis %></td>
        <td><%= article.deposit_eur %></td>
        <td><%= article.location.shortaddress %></td>
        <td><%= link_to article.user.nickname, user_path(article.user) %></td>
        <td><%= image_tag(article.picture_url(:thumb)) if article.picture.present? %></td>
        <td><%= link_to 'Show', article %></td>
        <td><%= link_to('Edit', edit_article_path(article)) if current_user and current_user.id == article.user.id %></td>
        <td><%= link_to('Destroy', article, method: :delete, data: { confirm: 'Are you sure?' } ) if current_user and current_user.id == article.user.id %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<br>

